# 스트림 API
## 스트림 API 의 장점
- 선언형: 더 간결하고 가독성이 좋아짐
- 조립할 수 있음: 유연성이 좋아짐
- 병렬화: 성능이 좋아짐

## 개념
- '데이터 처리 연산을 지원하도록 소스에서 추출된 연속된 요소(Sequence of elements)'로 정의할 수 있음
  - **연속된 요소**
    - 특정 요소 형식으로 이루진 연속된 값 집합의 인터페이스를 제공
  - **소스**
    - 컬렉션, 배열, I/O 자원 등의 데이터 제공 소스로부터 데이터를 소비함
  - **데이터 처리 연산**
    - 스트림은 함수형 프로그래밍 언어에서 일반적으로 지원하는 연산과 데이터베이스와 비슷한 연산을 지원
    - filter, map, reduce, find, match, sort 등으로 데이터를 조작
    - 순차적 또는 병렬으로 실행할 수 있음

- 2가지 중요한 특성
  1. **파이프라이닝**
     - 대부분의 스트림 연산 -> 스트림 자신을 반환
     - 파이프라인을 구성할 수 있도록
     - 게으름(laziness), 쇼트 서킷(short-circuiting) 같은 최적화도 얻을 수 있음
  2. **내부 반복**
    - 명시적으로 반복하는 컬렉션과 달리 스트림은 내부 반복을 지원

```java
public class HighCaloriesNames {
    public static void main(String[] args) {
        List<Dish> menu = Dish.menu;

        List<String> threeHighCaloricDishNames = menu.stream()
                .filter(dish -> dish.getCalories() > 300)
                .map(Dish::getName)
                .limit(3)
                .toList();
        System.out.println(threeHighCaloricDishNames);
    }
}
```
- 설명
  - filter
    - 람다를 인수로 받아 스트림에서 특정 요소를 제외
  - map
    - 람다를 이용해서 한 요소를 다른 요소로 변환하거나 정보를 추출
  - limit
    - 정해진 개수 이상의 요소가 스트림에 저장되지 못하게 스트림 크기를 축소 truncate 한다
  - collect
    - 스트림을 다른 형식으로 변환

## 스트림과 컬렉션
- 자바의 기존 컬렉션과 새로운 스트림 모두 연속된 요소 형식의 값을 저장하는 자료구조의 인터페이스를 제공
- **"연속된"**
  - 순서와 상관없이 아무 값에나 접속하는 것이 아니라 순차적으로 값에 접근한 다는 것을 의미

### 스트림과 컬렉션의 차이
- 데이터를 **언제** 계산하느냐
- 컬렉션:
  - 현재 자료구조가 포함하는 모든 값을 메모리에 저장하는 자료구조
  - 컬렉션의 모든 요소는 컬렉션에 추가하기 전에 계산되어야 함
  - 적극적으로 생성 (supplier-driven)
    - 팔기도 전에 창고를 가득 채움

- 스트림
  - **요청할 때만 요소를 계산**하는 고정된 자료구조
  - 스트림은 생산자 producer 와 소비자 consumer 관계를 형성
  - 게으르게 만들어지는 컬렉션과 동일

### 딱 한 번만 탐색할 수 있다
- 예제
```java
public class StreamExample {
    public static void main(String[] args) {
        List<String> title = Arrays.asList("Java8", "In", "Action");
        Stream<String> s = title.stream();
        s.forEach(System.out::println);
        s.forEach(System.out::println); // java.lang.IllegalStateException
    }
}
```

### 외부 반복과 내부 반복
- 외부 반복 (external iteration)
  - 컬렉션 인터페이스를 사용하려면 사용자가 직접 요소를 반복해야 함
- 내부 반복 (internal iteration)
  - 반복을 알아서 처리하고 결과 스트림값을 어딘가에 저장해주는
